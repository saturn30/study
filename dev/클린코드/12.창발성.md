# 12장 창발성

### 창발적 설계로 깔끔한 코드를 구현하자

- 착실하게 따르기만 하면 우수한 설계가 나오는 간단한 규칙 네 가지가 있다면?
- 네 가지 규칙을 따르면 코드 구조와 설계를 파악하기 쉬워진다면? 그래서 SRP, DIP와 같은 원칙을 적용하기 쉬워진다면? 네 가지 규칙이 우수한 설계의 창발성을 촉진한다면?
- 켄트 백이 제시한 단순한 설계 규칙 네 가지는 다음과 같다.
  - 모든 테스트를 실행한다.
  - 중복을 없앤다.
  - 프로그래머 의도를 표현한다.
  - 클래스와 메서드 수를 최소로 줄인다.
- 위 순서는 중요도 순이다.

### 단순한 설계 규칙 1: 모든 테스트를 실행하라

- 테스트가 불가능한 시스템은 검증이 불가능하다.
  - 검증이 불가능한 시스템은 절대 출시해선 안 된다.
- 다행스럽게도, 테스트가 가능한 시스템을 만들려고 애쓰면 설계 품질이 더불어 높아진다.
- 크기가 작고 목적 하나만 수행하는 클래스가 나온다.
- 테스트 케이스가 많을수록 개발자는 테스트가 쉽게 코드를 작성한다.
- 따라서 철저한 테스트가 가능한 시스템을 만들면 더 나은 설계가 얻어진다.
- 결합도가 높으면 테스트 케이스를 작성하기 어렵다.
- 그러므로 앞서와 마찬가지로, 테스트 케이스를 많이 작성할수록 개발자는 DIP와 같은 원칙을 적용하고 의존성 주입, 인터페이스, 추상화 등과 같은 도구를 사용해 결합도를 낮춘다.
- “테스트 케이스를 만들고 계속 돌려라"라는 간단하고 단순한 규칙을 따르면 시스템은 낮은 결합도와 높은 응집력이라는, 객체 지향 방법론이 지향하는 목표를 저절로 달성한다.
- 즉, 테스트 케이스를 작성하면 설계 품질이 높아진다.

### 단순한 설계 규칙 2~4: 리팩터링

- 테스트 케이스를 모두 작성했다면 이제 코드와 클래스를 정리해도 된다.
- 코드를 점진적으로 리팩터링한다.
- 소프트웨어 설계 품질을 높이는 기법이라면 무엇이든 적용해도 괜찮다.
- 응집도를 높이고, 결합도를 낮추고, 관심사를 분리하고, 시스템 관심사를 모듈로 나누고, 함수와 클래스 크기를 줄이고, 더 나은 이름을 선택하고.. 등등
- 코드를 정리하면서 시스템이 깨질까봐 걱정할 필요가 없다. 테스트 케이스가 있으니까.

### 중복을 없애라

- 중복은 추가 작업, 추가 위험, 불필요한 복잡도를 뜻하기 때문에 설계에서 커다란 적이다.
- 중복은 여러가지 형태로 표출된다. 똑같은 코드는 당연히 중복이다.
- 비슷한 코드는 더 비슷하게 고쳐주면 리팩토링이 쉬워진다.

### 표현하라

- 자신이 이해하는 코드를 짜기는 쉽다. 코드를 짜는 동안 문제에 빠져 코드를 구석구석이해하니까.
- 하지만 나중에 코드를 유지보수할 사람이 코드를 짜는 사람만큼이나 문제를 깊이 이해할 가능성은 희박하다.
- 소프트웨어 프로젝트 비용 중 대다수는 장기적인 유지보수에 들어간다.
- 코드를 변경하면서 버그의 싹을 심지 않으려면 유지보수 개발자가 시스템을 제대로 이해해야 한다.
- 그러므로 코드는 개발자의 의도를 분명히 표현해야 한다.
- 개발자가 코드를 명백하게 짤수록 다른 사람이 그 코드를 이해하기 쉬워진다.
- 그래야 결함이 줄어들고 유지보수 비용이 적게 든다.
  - 우선 좋은 이름을 선택하자.
  - 둘째로 함수와 클래스 크기를 가능한 줄인다.
  - 표준 명칭을 사용한다.
  - 단위 테스트를 꼼꼼히 작성하자. 테스트 케이스는 소위 ‘예제를 보여주는 문서'이다. 다시 말해, 잘 만든 테스트 케이스를 읽어보면 클래스의 기능이 한눈에 들어온다.
- 표현력을 높이는 가장 중요한 방법은 노력이다.
- 흔히 코드만 돌린 후 다음 문제로 가는 사례가 너무도 흔하다.
- 나중에 읽을 사람을 고려해 조금이라도 읽기 쉽게 만들려고 고민하자.

### 클래스와 메서드 수를 최소로 줄여라

- 중복을 제거하고, 의도를 표현하고, SRP를 준수한다는 기본적인 개념도 극단으로 치달으면 득보다 실이 많아진다.
- 클래스와 메서드 크기를 줄이자고 조그만 클래스와 메서드를 수없이 만드는 사례도 없지 않다.
- 목표는 함수와 클래스 크기를 작게 유지하면서 동시에 시스템 크기도 작게 유지하는 데 있다.

### 결론

- 이 책에서 소개하는 기법은 수십년 동안 쌓은 경험의 정수이니 그냥 따르도록.
